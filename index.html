<!DOCTYPE html>
<html>
<head>
  <title>Auto Location Tracker</title>
</head>
<body>
  <h2>Auto Location Tracker</h2>
  <p>Status: <span id="status">Waiting...</span></p>

  <script>
    function sendLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          fetch('https://thejokes.pythonanywhere.com/update_location', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              phone: "son123",  // Unique phone/user identifier
              lat: position.coords.latitude,
              lng: position.coords.longitude
            })
          })
          .then(res => res.json())
          .then(data => {
            console.log("Sent:", data);
            document.getElementById('status').innerText = "Location sent at " + new Date().toLocaleTimeString();
          })
          .catch(err => {
            console.error("Send error:", err);
            document.getElementById('status').innerText = "Failed to send location.";
          });
        }, function(error) {
          document.getElementById('status').innerText = "Error getting location: " + error.message;
        });
      } else {
        document.getElementById('status').innerText = "Geolocation not supported.";
      }
    }

    // Send location every 5 minutes
    sendLocation(); // Run immediately
    setInterval(sendLocation, 5 * 60 * 1000); // Repeat every 5 min
  </script>
</body>
</html>
