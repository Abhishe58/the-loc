<!DOCTYPE html>
<html>
<head>
  <title>Auto Location Tracker</title>
</head>
<body>
  
  <h2>Auto Location Tracker.</h2>
  <p>Status: <span id="status">Waiting...</span></p>

  <script>
    function sendLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          fetch('https://thejokes.pythonanywhere.com/update_location', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              phone: "tiger",
              lat: position.coords.latitude,
              lng: position.coords.longitude
            })
          })
          .then(res => res.json())
          .then(data => {
            document.getElementById('status').innerText = "Location sent at " + new Date().toLocaleTimeString();
          })
          .catch(() => {
            document.getElementById('status').innerText = "Failed to send location.";
          });
        });
      }
    }

    // Run every 5 minutes (300000 ms)
    sendLocation(); // Run immediately
    setInterval(sendLocation, 300000); // Every 5 minutes

  navigator.geolocation.getCurrentPosition(function(pos) {
    alert("Latitude: " + pos.coords.latitude + "\nLongitude: " + pos.coords.longitude);
  }, function(error) {
    alert("Error: " + error.message);
  });
  </script>
</body>
</html>
